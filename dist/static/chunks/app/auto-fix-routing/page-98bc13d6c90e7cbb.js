(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7409],{42099:(e,t,i)=>{"use strict";i.d(t,{N:()=>n});let n=(0,i(55647).UU)("https://yhznjxfzpthmyyhbhihp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inloem5qeGZ6cHRobXl5aGJoaWhwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQyNDE0MzcsImV4cCI6MjA2OTgxNzQzN30.BlP9YoilaPopQgkZXZa-_WJPUIjnX9nTyYspaBV0Cqc")},58382:(e,t,i)=>{Promise.resolve().then(i.bind(i,75351))},75351:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(95155),a=i(12115),s=i(42099);function o(){let[e,t]=(0,a.useState)(!1),[i,o]=(0,a.useState)([]),[c,r]=(0,a.useState)(!1);(0,a.useEffect)(()=>{c&&d()},[c]);let l=e=>{o(t=>[...t,e])},d=async()=>{t(!0),o([]);try{l("\uD83D\uDD27 Starting automatic routing fix...");let{data:e,error:t}=await s.N.from("organizations").select("id, name");if(t)return void l("❌ Error fetching organizations: ".concat(t.message));for(let t of(l("\uD83D\uDCCB Found ".concat((null==e?void 0:e.length)||0," organizations")),e||[])){l("\uD83D\uDD0D Checking organization: ".concat(t.name));let{data:e,error:i}=await s.N.from("organization_sidebar_items").select("*").eq("organization_id",t.id);if(i){l("  ❌ Error fetching sidebar items: ".concat(i.message));continue}l("  \uD83D\uDCCB Found ".concat((null==e?void 0:e.length)||0," sidebar items"));let n=[];for(let t of e||[]){if(t.is_system)continue;let{data:e,error:i}=await s.N.from("page_contents").select("id").eq("sidebar_item_id",t.id);if(i){l("    ⚠️ Error checking content for ".concat(t.item_name,": ").concat(i.message));continue}e&&0!==e.length||(n.push(t),l('    ⚠️ NO CONTENT: "'.concat(t.item_name,'" (').concat(t.item_slug,")"))),["onsite-information","emergency-contacts","after-hours-access","site-access","onsite","emergency"].some(e=>t.item_slug.includes(e))&&!n.find(e=>e.id===t.id)&&(n.push(t),l('    ⚠️ PROBLEMATIC SLUG: "'.concat(t.item_name,'" (').concat(t.item_slug,")")))}if(n.length>0)for(let e of(l("  \uD83D\uDDD1️ Deleting ".concat(n.length," problematic items...")),n))try{let{error:t}=await s.N.from("page_contents").delete().eq("sidebar_item_id",e.id);t&&l("    ⚠️ Warning deleting content for ".concat(e.item_name,": ").concat(t.message));let{error:i}=await s.N.from("organization_sidebar_items").delete().eq("id",e.id);i?l("    ❌ Error deleting ".concat(e.item_name,": ").concat(i.message)):l('    ✅ Deleted: "'.concat(e.item_name,'"'))}catch(t){l("    ❌ Exception deleting ".concat(e.item_name,": ").concat(t.message))}else l("  ✅ No problematic items found in ".concat(t.name))}l("\uD83E\uDDF9 Cleaning up orphaned page contents...");let{data:i,error:n}=await s.N.from("page_contents").select("\n          id,\n          sidebar_item_id,\n          organization_sidebar_items!inner(id)\n        ");if(n)l("⚠️ Could not check for orphaned contents: ".concat(n.message));else{let{data:e}=await s.N.from("page_contents").select("id, sidebar_item_id"),{data:t}=await s.N.from("organization_sidebar_items").select("id"),i=new Set((null==t?void 0:t.map(e=>e.id))||[]),n=(null==e?void 0:e.filter(e=>!i.has(e.sidebar_item_id)))||[];if(n.length>0)for(let e of(l("\uD83D\uDDD1️ Found ".concat(n.length," orphaned page contents, deleting...")),n)){let{error:t}=await s.N.from("page_contents").delete().eq("id",e.id);t?l("  ❌ Error deleting orphaned content: ".concat(t.message)):l("  ✅ Deleted orphaned content: ".concat(e.id))}else l("✅ No orphaned page contents found")}l("\uD83C\uDF89 Automatic fix completed successfully!"),l("\uD83D\uDD04 Please refresh your browser and test navigation")}catch(e){l("❌ Auto-fix failed: ".concat(e.message))}t(!1)};return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"\uD83D\uDD27 Automatic Routing Fix"}),(0,n.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg mb-6",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Automatic Fix"}),(0,n.jsx)("p",{className:"text-gray-300 mb-6",children:"This will automatically scan ALL organizations and fix ALL routing issues by:"}),(0,n.jsxs)("ul",{className:"text-gray-300 text-sm space-y-2 mb-6",children:[(0,n.jsx)("li",{children:"• Finding sidebar items without page content"}),(0,n.jsx)("li",{children:"• Removing items with problematic slugs (onsite, emergency, etc.)"}),(0,n.jsx)("li",{children:"• Cleaning up orphaned page contents"}),(0,n.jsx)("li",{children:"• Preserving all system sidebar items"}),(0,n.jsx)("li",{children:"• Giving you clean, working navigation"})]}),(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)("button",{onClick:d,disabled:e,className:"px-6 py-3 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 rounded text-white font-medium",children:e?"Fixing...":"\uD83D\uDD27 Auto-Fix All Issues"}),(0,n.jsx)("button",{onClick:()=>r(!0),disabled:e||c,className:"px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 rounded text-white font-medium",children:c?"Running...":"⚡ Auto-Run on Load"})]})]}),i.length>0&&(0,n.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg",children:[(0,n.jsx)("h3",{className:"font-medium mb-4",children:"Fix Results:"}),(0,n.jsx)("div",{className:"space-y-1 text-sm font-mono max-h-96 overflow-y-auto",children:i.map((e,t)=>(0,n.jsx)("div",{className:e.includes("✅")?"text-green-400":e.includes("❌")?"text-red-400":e.includes("⚠️")?"text-yellow-400":e.includes("\uD83C\uDF89")?"text-blue-400":e.includes("\uD83D\uDD27")?"text-purple-400":"text-gray-300",children:e},t))})]}),(0,n.jsxs)("div",{className:"mt-6 bg-blue-900/20 border border-blue-600 rounded-lg p-4",children:[(0,n.jsx)("h3",{className:"text-blue-400 font-semibold mb-2",children:"\uD83C\uDFAF What This Fix Does:"}),(0,n.jsxs)("ul",{className:"text-blue-200 text-sm space-y-1",children:[(0,n.jsx)("li",{children:"• Scans ALL organizations automatically"}),(0,n.jsx)("li",{children:'• Finds sidebar items causing "Page not found" errors'}),(0,n.jsx)("li",{children:"• Removes problematic items (onsite, emergency, etc.)"}),(0,n.jsx)("li",{children:"• Cleans up database inconsistencies"}),(0,n.jsx)("li",{children:"• Preserves working sidebar items"}),(0,n.jsx)("li",{children:"• Gives you a clean slate for testing"})]})]})]})}}},e=>{e.O(0,[5647,8441,5964,7358],()=>e(e.s=58382)),_N_E=e.O()}]);