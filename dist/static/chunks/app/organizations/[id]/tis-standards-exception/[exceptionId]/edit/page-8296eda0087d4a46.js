(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3953],{4229:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(19946).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},35169:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},51154:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},54232:(e,t,s)=>{Promise.resolve().then(s.bind(s,72759))},54416:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(19946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},72759:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(95155),a=s(12115),i=s(35695),n=s(42099),l=s(77470),c=s(94615),o=s(95060),d=s(51154),x=s(1243),u=s(35169),m=s(57434),h=s(85339),p=s(69074),g=s(54416),b=s(4229);function f(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),{success:s,error:f}=(0,l.E$)(),[y,j]=(0,a.useState)(!0),[v,N]=(0,a.useState)(!1),[w,k]=(0,a.useState)(null);(0,a.useEffect)(()=>{C()},[e.exceptionId]);let C=async()=>{try{let{data:t,error:s}=await n.N.from("tis_standards_exceptions").select("*").eq("id",e.exceptionId).eq("organization_id",e.id).single();if(s)throw s;k(t)}catch(e){f("Failed to load exception. Please try again."),t.back()}finally{j(!1)}},_=e=>{if(!w)return;let{name:t,value:s}=e.target;k(e=>e?{...e,[t]:s}:null)},A=async r=>{if(r.preventDefault(),!w)return;let a=(()=>{if(!w)return["Exception data not loaded"];let e=[];return w.exception_title.trim()||e.push("Exception title is required"),w.standard_reference.trim()||e.push("Standard reference is required"),w.description.trim()||e.push("Description is required"),w.justification.trim()||e.push("Justification is required"),w.risk_assessment.trim()||e.push("Risk assessment is required"),"temporary"!==w.exception_type||w.expiry_date||e.push("Expiry date is required for temporary exceptions"),e})();if(a.length>0)return void f("Please fix the following errors: ".concat(a.join(", ")));N(!0);try{let{error:r}=await n.N.from("tis_standards_exceptions").update({...w,updated_at:new Date().toISOString()}).eq("id",e.exceptionId).eq("organization_id",e.id);if(r)throw r;s("TIS Standards Exception updated successfully!"),t.push("/organizations/".concat(e.id,"/tis-standards-exception"))}catch(e){f("Failed to update TIS Standards Exception. Please try again.")}finally{N(!1)}},q=s=>{s.href&&("/"===s.href?t.push("/"):t.push("/organizations/".concat(e.id).concat(s.href)))};return y?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white",children:[(0,r.jsx)(c.default,{currentPage:"Organizations"}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(o.A,{onItemClick:q}),(0,r.jsx)("div",{className:"flex-1 p-6 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(d.A,{className:"w-8 h-8 animate-spin text-blue-500 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Loading exception..."})]})})]})]}):w?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white",children:[(0,r.jsx)(c.default,{currentPage:"Organizations"}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(o.A,{onItemClick:q}),(0,r.jsxs)("div",{className:"flex-1 p-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>t.back(),className:"p-2 text-gray-400 hover:text-white transition-colors",children:(0,r.jsx)(u.A,{className:"w-5 h-5"})}),(0,r.jsx)("div",{className:"w-12 h-12 bg-red-600 rounded-full flex items-center justify-center",children:(0,r.jsx)(x.A,{className:"w-6 h-6 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold",children:"Edit TIS Standards Exception"}),(0,r.jsx)("div",{className:"text-sm text-gray-400",children:w.exception_title})]})]})}),(0,r.jsx)("form",{onSubmit:A,className:"max-w-4xl",children:(0,r.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center space-x-2",children:[(0,r.jsx)(m.A,{className:"w-5 h-5 text-blue-400"}),(0,r.jsx)("span",{children:"Basic Information"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Exception Title *"}),(0,r.jsx)("input",{type:"text",name:"exception_title",value:w.exception_title,onChange:_,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Standard Reference *"}),(0,r.jsx)("input",{type:"text",name:"standard_reference",value:w.standard_reference,onChange:_,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Exception Type *"}),(0,r.jsxs)("select",{name:"exception_type",value:w.exception_type,onChange:_,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"temporary",children:"Temporary"}),(0,r.jsx)("option",{value:"permanent",children:"Permanent"}),(0,r.jsx)("option",{value:"conditional",children:"Conditional"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Severity *"}),(0,r.jsxs)("select",{name:"severity",value:w.severity,onChange:_,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"low",children:"Low"}),(0,r.jsx)("option",{value:"medium",children:"Medium"}),(0,r.jsx)("option",{value:"high",children:"High"}),(0,r.jsx)("option",{value:"critical",children:"Critical"})]})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center space-x-2",children:[(0,r.jsx)(h.A,{className:"w-5 h-5 text-yellow-400"}),(0,r.jsx)("span",{children:"Details"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description *"}),(0,r.jsx)("textarea",{name:"description",value:w.description,onChange:_,required:!0,rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Business Justification *"}),(0,r.jsx)("textarea",{name:"justification",value:w.justification,onChange:_,required:!0,rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Risk Assessment *"}),(0,r.jsx)("textarea",{name:"risk_assessment",value:w.risk_assessment,onChange:_,required:!0,rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Mitigation Plan"}),(0,r.jsx)("textarea",{name:"mitigation_plan",value:w.mitigation_plan||"",onChange:_,rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold mb-4 flex items-center space-x-2",children:[(0,r.jsx)(p.A,{className:"w-5 h-5 text-green-400"}),(0,r.jsx)("span",{children:"Approval & Timeline"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Approved By"}),(0,r.jsx)("input",{type:"text",name:"approved_by",value:w.approved_by||"",onChange:_,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Approval Date"}),(0,r.jsx)("input",{type:"date",name:"approval_date",value:w.approval_date||"",onChange:_,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),"temporary"===w.exception_type&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Expiry Date *"}),(0,r.jsx)("input",{type:"date",name:"expiry_date",value:w.expiry_date||"",onChange:_,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),(0,r.jsxs)("select",{name:"status",value:w.status,onChange:_,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"pending",children:"Pending"}),(0,r.jsx)("option",{value:"approved",children:"Approved"}),(0,r.jsx)("option",{value:"rejected",children:"Rejected"}),(0,r.jsx)("option",{value:"expired",children:"Expired"})]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-700",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>t.back(),className:"flex items-center space-x-2 px-6 py-2 text-gray-400 hover:text-white transition-colors",children:[(0,r.jsx)(g.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Cancel"})]}),(0,r.jsxs)("button",{type:"submit",disabled:v,className:"flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 px-6 py-2 rounded-lg transition-colors",children:[(0,r.jsx)(b.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:v?"Saving...":"Save Changes"})]})]})]})})]})]})]}):(0,r.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white",children:[(0,r.jsx)(c.default,{currentPage:"Organizations"}),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(o.A,{onItemClick:q}),(0,r.jsx)("div",{className:"flex-1 p-6 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(x.A,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Exception Not Found"}),(0,r.jsx)("p",{className:"text-gray-400 mb-4",children:"The requested exception could not be found."}),(0,r.jsx)("button",{onClick:()=>t.back(),className:"bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded transition-colors",children:"Go Back"})]})})]})]})}},77470:(e,t,s)=>{"use strict";s.d(t,{E$:()=>x,NotificationProvider:()=>d});var r=s(95155),a=s(12115),i=s(40646),n=s(1243),l=s(81284),c=s(54416);let o=(0,a.createContext)(void 0);function d(e){let{children:t}=e,[s,i]=(0,a.useState)([]),n=(0,a.useCallback)(e=>{let t=Math.random().toString(36).substr(2,9),s={id:t,duration:5e3,...e};return i(e=>[...e,s]),!s.persistent&&s.duration&&setTimeout(()=>{l(t)},s.duration),t},[]),l=(0,a.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[]),c=(0,a.useCallback)(()=>{i([])},[]),d=(0,a.useCallback)((e,t)=>n({type:"success",message:e,...t}),[n]),x=(0,a.useCallback)((e,t)=>n({type:"error",message:e,duration:8e3,...t}),[n]),m=(0,a.useCallback)((e,t)=>n({type:"warning",message:e,...t}),[n]),h=(0,a.useCallback)((e,t)=>n({type:"info",message:e,...t}),[n]);return(0,r.jsxs)(o.Provider,{value:{notifications:s,addNotification:n,removeNotification:l,clearAll:c,success:d,error:x,warning:m,info:h},children:[t,(0,r.jsx)(u,{})]})}function x(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useNotifications must be used within a NotificationProvider");return e}function u(){let{notifications:e,removeNotification:t}=x();return 0===e.length?null:(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm",children:e.map(e=>(0,r.jsx)(m,{notification:e,onDismiss:()=>t(e.id)},e.id))})}function m(e){let{notification:t,onDismiss:s}=e,a=()=>{switch(t.type){case"success":return"text-green-100";case"error":return"text-red-100";case"warning":return"text-yellow-100";case"info":return"text-blue-100"}};return(0,r.jsx)("div",{className:"".concat((()=>{switch(t.type){case"success":return"bg-green-900/90 border-green-600";case"error":return"bg-red-900/90 border-red-600";case"warning":return"bg-yellow-900/90 border-yellow-600";case"info":return"bg-blue-900/90 border-blue-600"}})()," border rounded-lg p-4 shadow-lg animate-in slide-in-from-right duration-300"),children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(()=>{switch(t.type){case"success":return(0,r.jsx)(i.A,{className:"w-5 h-5 text-green-400"});case"error":return(0,r.jsx)(n.A,{className:"w-5 h-5 text-red-400"});case"warning":return(0,r.jsx)(n.A,{className:"w-5 h-5 text-yellow-400"});case"info":return(0,r.jsx)(l.A,{className:"w-5 h-5 text-blue-400"})}})()}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[t.title&&(0,r.jsx)("h4",{className:"".concat(a()," font-medium mb-1"),children:t.title}),(0,r.jsx)("p",{className:"".concat(a()," text-sm"),children:t.message}),t.action&&(0,r.jsx)("button",{onClick:t.action.onClick,className:"mt-2 text-xs font-medium ".concat("success"===t.type?"text-green-300 hover:text-green-200":"error"===t.type?"text-red-300 hover:text-red-200":"warning"===t.type?"text-yellow-300 hover:text-yellow-200":"text-blue-300 hover:text-blue-200"," transition-colors"),children:t.action.label})]}),(0,r.jsx)("button",{onClick:s,className:"flex-shrink-0 text-gray-400 hover:text-white transition-colors",children:(0,r.jsx)(c.A,{className:"w-4 h-4"})})]})})}},85339:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(19946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])}},e=>{e.O(0,[5647,6441,7365,3930,8441,5964,7358],()=>e(e.s=54232)),_N_E=e.O()}]);